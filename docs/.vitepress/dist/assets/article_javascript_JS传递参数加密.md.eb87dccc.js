import{_ as l,H as p,o,c as t,J as e,E as c,V as r,C as s,a as n}from"./chunks/framework.ed8632ae.js";const m=JSON.parse('{"title":"ğŸ˜ JSä¼ é€’å‚æ•°åŠ å¯†","description":"","frontmatter":{},"headers":[],"relativePath":"article/javascript/JSä¼ é€’å‚æ•°åŠ å¯†.md","filePath":"article/javascript/JSä¼ é€’å‚æ•°åŠ å¯†.md"}'),y={name:"article/javascript/JSä¼ é€’å‚æ•°åŠ å¯†.md"},D=r(`<h1 id="jsä¼ é€’å‚æ•°åŠ å¯†" tabindex="-1">ğŸ˜ JSä¼ é€’å‚æ•°åŠ å¯† <a class="header-anchor" href="#jsä¼ é€’å‚æ•°åŠ å¯†" aria-label="Permalink to &quot;:elephant: JSä¼ é€’å‚æ•°åŠ å¯†&quot;">â€‹</a></h1><blockquote><p>åœ¨æ—¥å¸¸å¼€å‘å­¦ä¹ ä¸­ï¼Œè‚¯å®šä¼šæˆ–å¤šæˆ–å°‘ç”¨åˆ°å‚æ•°åŠ å¯†ï¼Œä»¥ä¸‹æ˜¯æˆ‘åœ¨å·¥ä½œä¸­é‡åˆ°çš„å‚æ•°åŠ å¯†ä¸šåŠ¡åŠŸèƒ½ï¼Œä¸€èµ·çœ‹çœ‹å§....</p></blockquote><ol><li>uniappå‚æ•°åŠ å¯†(ä¼ è¾“ç»™åç«¯å‚æ•°åŠ å¯†) <ol><li>1.ä½¿ç”¨npm install crypto ä¸‹è½½åŠ å¯†æ‰€éœ€æ–‡ä»¶</li><li>2.åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªutilsæ–‡ä»¶å¤¹ï¼Œåˆ›å»ºä¸€ä¸ªencryption.jsæ–‡ä»¶å†™å…¥å¦‚ä¸‹ä»£ç å—</li></ol></li></ol><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">let</span><span style="color:#BABED8;"> CryptoJS </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">require</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">crypto-js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">	</span><span style="color:#676E95;font-style:italic;">// CryptoåŠ å¯†æ–¹æ³•å°è£…</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> aesUtil </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;"> 	</span><span style="color:#676E95;font-style:italic;">// åŠ å¯†å‡½æ•¸</span></span>
<span class="line"><span style="color:#BABED8;"> 	</span><span style="color:#82AAFF;">encrypt</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">word</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">keyStr</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;"> 		</span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">word</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">instanceof</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Object</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;"> 			</span><span style="color:#676E95;font-style:italic;">//JSON.stringify</span></span>
<span class="line"><span style="color:#F07178;"> 			</span><span style="color:#BABED8;">word</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">JSON</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">stringify</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">word</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;"> 		</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;"> 		</span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">enc</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Utf8</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parse</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">keyStr</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;"> 		</span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">encryptedObj</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">AES</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">encrypt</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">enc</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Utf8</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parse</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">word</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">key</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;"> 			mode</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">mode</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">ECB</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;"> 			padding</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">pad</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Pkcs7</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;"> 		</span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> )</span></span>
<span class="line"><span style="color:#F07178;"> 		</span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">encryptedObj</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toString</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;"> 	</span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;"> 	</span><span style="color:#676E95;font-style:italic;">// è§£å¯†å‡½æ•¸</span></span>
<span class="line"><span style="color:#BABED8;"> 	</span><span style="color:#82AAFF;">decrypt</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">word</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">keyStr</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;"> 		</span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">key</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">enc</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Utf8</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parse</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">keyStr</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;"> 		</span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">decrypt</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">AES</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">decrypt</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">word</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">key</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;"> 			mode</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">mode</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">ECB</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;"> 			padding</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">pad</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">ZeroPadding</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;"> 		</span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> )</span></span>
<span class="line"><span style="color:#F07178;"> 		</span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">decString</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">enc</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Utf8</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">stringify</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">decrypt</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toString</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;"> 		</span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">decString</span></span>
<span class="line"><span style="color:#F07178;"> 	</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">module.exports={</span></span>
<span class="line"><span style="color:#BABED8;">	 aesUtil</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">}</span></span></code></pre></div><ol start="3"><li>ä½¿ç”¨åŠ å¯†å‚æ•°åŠŸèƒ½å‡½æ•° <ol><li>åœ¨éœ€è¦ä½¿ç”¨åŠ å¯†çš„é¡µé¢å¼•å…¥encryption.jsæ–‡ä»¶ <ol><li>import Encry from &#39;@/utils/encryption.js&#39;</li></ol></li><li>2.åœ¨ä½¿ç”¨çš„é¡µé¢å¼•å…¥ä¸åç«¯çº¦å®šçš„key(éå¸¸é‡è¦ï¼Œå¯ä»¥æŒ‚è½½å…¨å±€å˜é‡)ï¼Œexample: const key=&quot;cd10239350d94d639cba546a876c0daa&quot;</li></ol></li></ol><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//  åˆå§‹åŒ–è‡ªå®šä¹‰å‚æ•°</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> key</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cd10239350d94d639cba546a876c0daa</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;">// å‰ç«¯ä¸åç«¯çº¦å®šçš„å…±åŒåè®®å¯†åŒ™key</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> postData</span><span style="color:#89DDFF;">={</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">å°é‚±</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#F07178;">age</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">21</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#F07178;">height</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">175</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#BABED8;"> console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(Encry</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">aesUtil</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">encrypt</span><span style="color:#BABED8;">(postData</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;">key)</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">å‚æ•°åŠ å¯†æŸ¥çœ‹</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#BABED8;"> console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(Encry</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">aesUtil</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">decrypt</span><span style="color:#BABED8;">(postData</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;">key)</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">å‚æ•°è§£å¯†æŸ¥çœ‹</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#BABED8;"> uni</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">request</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#F07178;">url</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fdfsdf</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#F07178;">data</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> Encry</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">aesUtil</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">encrypt</span><span style="color:#BABED8;">(postData</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> key)</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;">// è¯·æ±‚å‚æ•°åŠ å¯†</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#F07178;">methods</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">GET</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#F07178;">header</span><span style="color:#89DDFF;">:{</span></span>
<span class="line"><span style="color:#89DDFF;">     </span><span style="color:#676E95;font-style:italic;">// é…ç½®è¯·æ±‚å¤´ä¿¡æ¯</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#F07178;">success</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">res</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#F07178;">     </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">res</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span></code></pre></div><ol start="2"><li>è§£å¯†åç«¯è¿”å›å‚æ•° <ol><li>åœ¨utilsæ–‡ä»¶å¤¹å†…åˆ›å»ºä¸€ä¸ªWXBizDataCrypt.jsæ–‡ä»¶ï¼Œå†™å…¥ä»¥ä¸‹ä»£ç </li></ol></li></ol><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">var</span><span style="color:#BABED8;"> crypto </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">require</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">crypto</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">WXBizDataCrypt</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">appId</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">sessionKey</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">appId</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">appId</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">sessionKey</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">sessionKey</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">WXBizDataCrypt</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">prototype</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">decryptData</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">encryptedData</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">iv</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// base64 decode</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">sessionKey</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Buffer</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">sessionKey</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">base64</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">encryptedData</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Buffer</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">encryptedData</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">base64</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">iv</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Buffer</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">iv</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">base64</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">     </span><span style="color:#676E95;font-style:italic;">// è§£å¯†</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">decipher</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">crypto</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createDecipheriv</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">aes-128-cbc</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">sessionKey</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">iv</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// è®¾ç½®è‡ªåŠ¨ padding ä¸º trueï¼Œåˆ é™¤å¡«å……è¡¥ä½</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">decipher</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setAutoPadding</span><span style="color:#F07178;">(</span><span style="color:#FF9CAC;">true</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">decoded</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">decipher</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">update</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">encryptedData</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">binary</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">decoded</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">decipher</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">final</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">decoded</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">JSON</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parse</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">decoded</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">err</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">throw</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Error</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Illegal Buffer</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#BABED8;">decoded</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">watermark</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">appid</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!==</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#BABED8;">appId</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">throw</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Error</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Illegal Buffer</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">decoded</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> WXBizDataCrypt</span></span></code></pre></div><ol start="2"><li>ä½¿ç”¨è§£å¯†åŠŸèƒ½å‡½æ•° <ol><li>åœ¨éœ€è¦ä½¿ç”¨çš„é¡µé¢å¼•å…¥è¯¥æ–‡ä»¶ <ol><li>import WXBizDataCrypt from &#39;@/utils/WXBizDataCrypt.js&#39;</li></ol></li><li>2.ä¾‹å¦‚æ‰‹æœºå·æˆæƒçš„æ—¶å€™</li></ol></li></ol><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 1.é¦–å…ˆé€šè¿‡uni.loginè·å–åˆ°sessionKeyå¹¶ç”¨å˜é‡ä¿å­˜</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 2.é€šè¿‡æ‰‹æœºå·æˆæƒè·å–åˆ°encryptedDataå’Œiv</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 3.æ¥ä¸‹æ¥è§£å¯†æ•°æ®è·å–æ‰‹æœºå·</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> data</span><span style="color:#89DDFF;">={</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">iv</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;">iv</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">encryptedData</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;">encryptedData</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">sessionKey</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;">sessionKey</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ä½¿ç”¨è§£å¯†è·å–æ•°æ® openIdä¸ºå°ç¨‹åºçš„openId,sessionKeyæ˜¯é€šè¿‡uni.loginè·å–åˆ°çš„sessionkey;</span></span>
<span class="line"><span style="color:#BABED8;">    let pc</span><span style="color:#89DDFF;">=new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">WXBizDataCrypt</span><span style="color:#BABED8;">(openId</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;">sesssionKey)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// è·å–dataçš„ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯é€šè¿‡æ‰‹æœºæˆæƒè·å–åˆ°çš„å‚æ•°</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> data</span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;">pc</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">decryptData</span><span style="color:#BABED8;">(encryptedData</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;">iv)</span><span style="color:#89DDFF;">;</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">    console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(data</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">phoneNumber</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">è·å–åˆ°çš„æ‰‹æœºå·ç </span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span></code></pre></div><ol start="3"><li>å‰ç«¯ä½¿ç”¨md5åŠ å¯† <ol><li>é¦–å…ˆä¸‹è½½md5åŠ å¯† <ol><li>æ‰“å¼€doså‘½ä»¤çª—å£ npm install js-md5 -D</li><li>åœ¨main.jsæ–‡ä»¶é‡Œå¼•å…¥å¹¶æŒ‚è½½å…¨å±€ <ol><li>mport Md5 from &#39;js-md5&#39;; // å¼•å…¥</li><li>Vue.prototype.$md5=Md5;</li></ol></li><li>åœ¨éœ€è¦ä½¿ç”¨md5åŠ å¯†çš„é¡µé¢ç›´æ¥ä½¿ç”¨ <ol><li>postDataæ˜¯è¯·æ±‚å‚æ•° æ—¶é—´æˆ³ signKey é¢„å®šçš„ä¸€ä¸ªå¯†é’¥</li><li>let result=$md5(JSON.stringify(postData)+(newDate().valueOf()siginKey)</li><li>resultå°±æ˜¯md5åŠ å¯†åçš„æ•°æ®</li></ol></li></ol></li></ol></li><li>4.åŸç”ŸHTMLä½¿ç”¨AESåŠ å¯†</li></ol><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">src</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://cdn.bootcdn.net/ajax/libs/crypto-js/4.0.0/crypto-js.min.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#C792EA;">var</span><span style="color:#BABED8;"> aseKey </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">12345678</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">     </span><span style="color:#676E95;font-style:italic;">//ç§˜é’¥å¿…é¡»ä¸ºï¼š8/16/32ä½</span></span>
<span class="line"><span style="color:#BABED8;">   </span><span style="color:#C792EA;">var</span><span style="color:#BABED8;"> message </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">13785624612</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//åŠ å¯†</span></span>
<span class="line"><span style="color:#C792EA;">var</span><span style="color:#BABED8;"> encrypt </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">AES</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">encrypt</span><span style="color:#BABED8;">(message</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">enc</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Utf8</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parse</span><span style="color:#BABED8;">(aseKey)</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">mode</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">mode</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">ECB</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">padding</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">pad</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Pkcs7</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toString</span><span style="color:#BABED8;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(encrypt)</span><span style="color:#89DDFF;">;</span><span style="color:#BABED8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//è§£å¯†</span></span>
<span class="line"><span style="color:#C792EA;">var</span><span style="color:#BABED8;"> decrypt </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">AES</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">decrypt</span><span style="color:#BABED8;">(encrypt</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">enc</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Utf8</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parse</span><span style="color:#BABED8;">(aseKey)</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">mode</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">mode</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">ECB</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">padding</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">pad</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Pkcs7</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toString</span><span style="color:#BABED8;">(CryptoJS</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">enc</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Utf8)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(decrypt)</span><span style="color:#89DDFF;">;</span><span style="color:#BABED8;">    </span><span style="color:#676E95;font-style:italic;">//13785624612</span></span></code></pre></div><ol><li>åŸè‰²JSä½¿ç”¨MD5åŠ å¯†ç”ŸæˆéªŒç­¾sign</li></ol><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">src</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://cdn.bootcdn.net/ajax/libs/blueimp-md5/2.19.0/js/md5.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">     </span><span style="color:#676E95;font-style:italic;">// data ä¸ºåŸå§‹å‚æ•°å¯¹è±¡  keyä¸ºMD5éªŒç­¾çš„Key</span></span>
<span class="line"><span style="color:#BABED8;">     </span><span style="color:#C792EA;">let</span><span style="color:#BABED8;"> sign</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">md5</span><span style="color:#BABED8;">(JSON</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">stringify</span><span style="color:#BABED8;">(data) </span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;"> (</span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">Date</span><span style="color:#BABED8;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">valueOf</span><span style="color:#BABED8;">()) </span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fdfdffsdfsf</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span><span style="color:#89DDFF;">,</span></span></code></pre></div>`,14),F=s("br",null,null,-1),B=s("ul",null,[s("li",null,[n("å¥½äº†ï¼Œä»¥ä¸Šçš„æ€»ç»“å°±åˆ°æ­¤ä¸ºæ­¢äº†ï¼Œå¦‚æœ"),s("code",null,"æœ‰ç–‘é—®å¯ä»¥ä¸é—®"),n("ä¹Ÿå¯ä»¥è”ç³»ä½œè€…ã€‚å’±ä»¬ä¸‹æœŸå†è§! Good bye! ğŸŒ¸")])],-1);function i(A,E,d,C,f,u){const a=p("font");return o(),t("div",null,[D,e(a,{color:"#dd00dd"},{default:c(()=>[n("ä¸æƒ³ä¸Šå›¾äº†ï¼Œå¦‚æœ‰ç–‘é—®å’¨è¯¢ä½œè€…")]),_:1}),F,B])}const S=l(y,[["render",i]]);export{m as __pageData,S as default};
